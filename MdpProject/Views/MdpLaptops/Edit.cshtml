@model MdpProject.Models.MdpLaptop

@{
    ViewData["Title"] = "Edit Laptop";
    Layout = "~/Views/Shared/_MdpAdminLayout.cshtml";
}

<div class="container my-4">
    <h2 class="mb-4 text-primary"><i class="bi bi-pencil-square"></i> @ViewData["Title"]</h2>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <form asp-action="Edit" method="post" enctype="multipart/form-data" class="row g-4 shadow-sm p-4 rounded bg-white">
        <input type="hidden" asp-for="MdpLaptopId" />

        <!-- Cột 1: Thông tin cơ bản -->
        <div class="col-md-6">
            <div class="mb-3">
                <label asp-for="MdpSanPhamId" class="form-label">Danh mục sản phẩm</label>
                <select asp-for="MdpSanPhamId" class="form-select" asp-items="ViewBag.MdpSanPhamId"></select>
                <span asp-validation-for="MdpSanPhamId" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="MdpTenLaptop" class="form-label">Tên Laptop</label>
                <input asp-for="MdpTenLaptop" class="form-control" />
                <span asp-validation-for="MdpTenLaptop" class="text-danger"></span>
            </div>

            <div class="row g-2">
                <div class="col-md-6 mb-3">
                    <label class="form-label">CPU</label>
                    <input asp-for="MdpCpu" class="form-control" />
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label">RAM</label>
                    <input asp-for="MdpRam" class="form-control" />
                </div>
            </div>

            <div class="row g-2">
                <div class="col-md-6 mb-3">
                    <label class="form-label">Storage</label>
                    <input asp-for="MdpStorage" class="form-control" />
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label">GPU</label>
                    <input asp-for="MdpGpu" class="form-control" />
                </div>
            </div>

            <div class="row g-2 mb-3">
                <div class="col-md-6">
                    <label class="form-label">Màn hình</label>
                    <input asp-for="MdpManHinh" class="form-control" />
                </div>
                <div class="col-md-6">
                    <label class="form-label">Pin</label>
                    <input asp-for="MdpPin" class="form-control" />
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Hệ điều hành</label>
                <input asp-for="MdpHeDieuHanh" class="form-control" />
            </div>
        </div>

        <!-- Cột 2: Upload / Paste ảnh + preview -->
        <div class="col-md-6">
            <div class="mb-3">
                <label class="form-label">Upload ảnh từ máy</label>
                <input type="file" name="imageFile" class="form-control" onchange="previewImage(event)" />
            </div>

            <div class="mb-3">
                <label class="form-label">Hoặc paste URL ảnh</label>
                <input type="text" name="imageUrl" class="form-control" placeholder="https://..." oninput="previewFromUrl(this.value)" />
            </div>

            <div class="mb-4">
                <label class="form-label">Preview ảnh</label>
                <div class="border rounded p-2 text-center bg-light">
                    <img id="preview" src="@TempData["LastUploadedImage"] ?? Model.MdpAnh" alt="Preview" class="img-fluid rounded" style="max-height:300px;" />
                </div>
            </div>
        </div>

        <!-- Nút Save / Back -->
        <div class="col-12 d-flex gap-2">
            <input type="submit" value="Lưu thay đổi" class="btn btn-primary btn-lg" />
            <a asp-action="Index" class="btn btn-secondary btn-lg">Quay lại</a>
        </div>
    </form>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")

    <script>
        function previewImage(event) {
            const reader = new FileReader();
            reader.onload = function () {
                document.getElementById('preview').src = reader.result;
            };
            reader.readAsDataURL(event.target.files[0]);
        }

        function previewFromUrl(url) {
            document.getElementById('preview').src = url;
        }
    </script>
}

<style>
    .form-control, .form-select {
        border-radius: 8px;
    }

    .btn-lg {
        min-width: 150px;
    }

    .shadow-sm {
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
</style>
